generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model agendamentos {
  id               Int                 @id @default(autoincrement())
  cliente_id       Int
  servico_id       Int
  data_hora_inicio DateTime            @db.Timestamp(6)
  data_hora_fim    DateTime            @db.Timestamp(6)
  observacao       String?
  pago             Boolean?            @default(false)
  status           status_agendamento? @default(AGENDADO)
  created_at       DateTime?           @default(now()) @db.Timestamp(6)
  clientes         clientes            @relation(fields: [cliente_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  servicos_salao   servicos_salao      @relation(fields: [servico_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model clientes {
  id                     Int                      @id @default(autoincrement())
  nome                   String                   @db.VarChar(100)
  telefone               String?                  @db.VarChar(20)
  endereco               String?
  data_cadastro          DateTime?                @default(now()) @db.Timestamp(6)
  ativo                  Boolean?                 @default(true)
  agendamentos           agendamentos[]
  ordens_servico_lavagem ordens_servico_lavagem[]
  veiculos               veiculos[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model itens_venda {
  id                  Int                  @id @default(autoincrement())
  venda_id            Int?
  produto_id          Int?
  quantidade          Int
  preco_unitario      Decimal              @db.Decimal(10, 2)
  produtos            produtos?            @relation(fields: [produto_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  vendas_conveniencia vendas_conveniencia? @relation(fields: [venda_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model ordens_servico_lavagem {
  id               Int               @id @default(autoincrement())
  cliente_id       Int?
  veiculo_id       Int?
  servico_id       Int?
  data_entrada     DateTime?         @default(now()) @db.Timestamp(6)
  data_conclusao   DateTime?         @db.Timestamp(6)
  status           status_lavagem?   @default(FILA)
  pago             Boolean?          @default(false)
  valor_final      Decimal           @db.Decimal(10, 2)
  clientes         clientes?         @relation(fields: [cliente_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  servicos_lavagem servicos_lavagem? @relation(fields: [servico_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  veiculos         veiculos?         @relation(fields: [veiculo_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model produtos {
  id            Int           @id @default(autoincrement())
  codigo_barras String        @unique @db.VarChar(50)
  nome          String        @db.VarChar(100)
  descricao     String?
  preco_venda   Decimal       @db.Decimal(10, 2)
  qtd_estoque   Int           @default(0)
  ativo         Boolean?      @default(true)
  itens_venda   itens_venda[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model servicos_lavagem {
  id                     Int                      @id @default(autoincrement())
  nome                   String                   @db.VarChar(100)
  descricao              String?
  valor                  Decimal                  @db.Decimal(10, 2)
  ativo                  Boolean?                 @default(true)
  ordens_servico_lavagem ordens_servico_lavagem[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model servicos_salao {
  id            Int            @id @default(autoincrement())
  codigo        String         @unique @db.VarChar(10)
  nome          String         @db.VarChar(100)
  valor         Decimal        @db.Decimal(10, 2)
  duracao_slots Int            @default(1)
  ativo         Boolean?       @default(true)
  agendamentos  agendamentos[]
}

model veiculos {
  id                     Int                      @id @default(autoincrement())
  cliente_id             Int?
  placa                  String?                  @unique @db.VarChar(10)
  modelo                 String?                  @db.VarChar(50)
  marca                  String?                  @db.VarChar(50)
  cor                    String?                  @db.VarChar(30)
  ordens_servico_lavagem ordens_servico_lavagem[]
  clientes               clientes?                @relation(fields: [cliente_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model vendas_conveniencia {
  id               Int           @id @default(autoincrement())
  data_venda       DateTime?     @default(now()) @db.Timestamp(6)
  valor_total      Decimal       @default(0) @db.Decimal(10, 2)
  metodo_pagamento String?       @db.VarChar(50)
  itens_venda      itens_venda[]
}

enum status_agendamento {
  AGENDADO
  CONCLUIDO
  CANCELADO
}

enum status_lavagem {
  FILA
  LAVANDO
  PRONTO
  ENTREGUE
}
